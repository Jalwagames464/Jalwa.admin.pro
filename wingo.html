<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jalwa God Mode - Admin</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --bg: #020617; --card: #0f172a; --primary: #00ffca; --green: #1DB954; --red: #ff4757; --violet: #9c27b0; }
        body { font-family: sans-serif; background: var(--bg); color: white; margin: 0; padding: 10px; }
        .header { background: var(--card); padding: 15px; border-bottom: 2px solid var(--primary); display:flex; justify-content:space-between; align-items:center; }
        .timer-val { font-family: monospace; font-size: 24px; color: var(--primary); }
        
        .color-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 20px 0; }
        .color-card { padding: 20px 10px; border-radius: 12px; text-align: center; font-weight: 900; cursor: pointer; transition: 0.3s; border: 2px solid transparent; position: relative;}
        
        .num-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; }
        .n-btn { width: 100%; aspect-ratio: 1; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; cursor: pointer; border: 2px solid #1e293b; position: relative;}
        
        /* ðŸš¨ ACTIVE FIX NEON BLINK */
        @keyframes active-blink { 50% { box-shadow: 0 0 20px var(--primary); border-color: white; transform: scale(1.05); } }
        .fixed-active { animation: active-blink 0.6s infinite; border-color: white !important; }

        @keyframes bet-blink { 50% { background: #851c1c; } }
        .high-bet { animation: bet-blink 0.4s infinite; border: 2px solid #fff !important; }

        .analysis { background: var(--card); padding: 15px; border-radius: 15px; margin-top: 20px; border: 1px solid #1e293b; }
        .row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px dashed #1e293b; }
        .advice { background: rgba(0,255,202,0.1); padding: 10px; border-radius: 10px; text-align: center; font-weight: 900; color: var(--primary); border: 1px dashed var(--primary); margin-top: 15px; }
    </style>
</head>
<body>

<div class="header">
    <div><small>PERIOD</small><br><b id="pIdDisplay" style="color:var(--primary)">...</b></div>
    <div class="timer-val" id="timer">00:00</div>
</div>

<div class="color-row">
    <div id="btnGreen" class="color-card" style="background:var(--green)" onclick="setFix('Green')">GREEN<br><span id="lG">â‚¹0</span></div>
    <div id="btnViolet" class="color-card" style="background:var(--violet)" onclick="setFix('Violet')">VIOLET<br><span id="lV">â‚¹0</span></div>
    <div id="btnRed" class="color-card" style="background:var(--red)" onclick="setFix('Red')">RED<br><span id="lR">â‚¹0</span></div>
</div>

<div class="num-grid" id="nGrid"></div>

<div class="analysis">
    <div class="row"><span>Total Collection:</span><b id="tColl">â‚¹0</b></div>
    <div class="row"><span>Payout If Green:</span><b id="pG" style="color:var(--red)">â‚¹0</b></div>
    <div class="row"><span>Payout If Red:</span><b id="pR" style="color:var(--red)">â‚¹0</b></div>
    <div class="advice" id="advice">ANALYZING BETS...</div>
    <button onclick="setFix('none')" style="width:100%; padding:15px; margin-top:10px; background:none; color:gray; border:1px solid #333; border-radius:10px; font-weight:bold;">RESET AUTO MODE</button>
</div>

<script>
    const firebaseConfig = { databaseURL: "https://jalwav7-default-rtdb.firebaseio.com" };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let grid = "";
    for(let i=0; i<=9; i++){
        let c = (i==0||i==5)?'#9c27b0':(i%2==0?'#ff4757':'#1DB954');
        grid += `<div id="nb${i}" class="n-btn" style="background:${c}" onclick="setFix(${i})">${i}<br><span id="v${i}" style="font-size:10px">â‚¹0</span></div>`;
    }
    document.getElementById('nGrid').innerHTML = grid;

    function setFix(v) { 
        db.ref('gameControl/manualResult').set(v); 
    }

    db.ref('gameControl/manualResult').on('value', snap => {
        let v = snap.val();
        document.querySelectorAll('.color-card, .n-btn').forEach(el => el.classList.remove('fixed-active'));
        if(v === 'Green') document.getElementById('btnGreen').classList.add('fixed-active');
        else if(v === 'Red') document.getElementById('btnRed').classList.add('fixed-active');
        else if(v === 'Violet') document.getElementById('btnViolet').classList.add('fixed-active');
        else if(typeof v === 'number') document.getElementById('nb'+v).classList.add('fixed-active');
    });

    db.ref('gameControl/wingo/liveBets').on('value', snap => {
        const bets = snap.val() || {};
        let total = 0, gP = 0, rP = 0, max = 0, maxId = "";
        const map = [
            {id:'nb0',v:'v0',a:bets.num0||0},{id:'nb1',v:'v1',a:bets.num1||0},{id:'nb2',v:'v2',a:bets.num2||0},
            {id:'nb3',v:'v3',a:bets.num3||0},{id:'nb4',v:'v4',a:bets.num4||0},{id:'nb5',v:'v5',a:bets.num5||0},
            {id:'nb6',v:'v6',a:bets.num6||0},{id:'nb7',v:'v7',a:bets.num7||0},{id:'nb8',v:'v8',a:bets.num8||0},
            {id:'nb9',v:'v9',a:bets.num9||0},{id:'btnGreen',v:'lG',a:bets.Green||0},
            {id:'btnRed',v:'lR',a:bets.Red||0},{id:'btnViolet',v:'lV',a:bets.Violet||0}
        ];

        map.forEach(m => {
            total += m.a;
            document.getElementById(m.v).innerText = "â‚¹" + m.a;
            document.getElementById(m.id).classList.remove('high-bet');
            if(m.a > max) { max = m.a; maxId = m.id; }
        });
        if(maxId && max > 0) document.getElementById(maxId).classList.add('high-bet');

        gP = (bets.Green||0)*2 + (bets.num1||0)*9 + (bets.num3||0)*9 + (bets.num7||0)*9 + (bets.num9||0)*9;
        rP = (bets.Red||0)*2 + (bets.num2||0)*9 + (bets.num4||0)*9 + (bets.num6||0)*9 + (bets.num8||0)*9;
        
        document.getElementById('tColl').innerText = "â‚¹" + total;
        document.getElementById('pG').innerText = "â‚¹" + gP;
        document.getElementById('pR').innerText = "â‚¹" + rP;
        if(total > 0) document.getElementById('advice').innerText = gP < rP ? "ADVICE: WIN GREEN" : "ADVICE: WIN RED";
    });

    setInterval(() => {
        const now = new Date(); const rem = 30 - (now.getSeconds() % 30);
        document.getElementById('timer').innerText = "00:" + rem.toString().padStart(2,'0');
        let pid = now.getFullYear().toString() + (now.getMonth()+1).toString().padStart(2,'0') + now.getDate().toString().padStart(2,'0') + Math.floor(((now.getHours()*3600)+(now.getMinutes()*60)+now.getSeconds())/30);
        document.getElementById('pIdDisplay').innerText = pid;
    }, 1000);
</script>
</body>
</html>
